{"ID":"d970f81f-5942-4afb-a97d-2968c6c42704","VersionNumber":1,"Name":"Server is not patched against Spectre/Meltdown vulnerability","Description":"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<head>\r\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>\r\n\t\t</title>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t.cs2654AE3A{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}\r\n\t\t\t.csBEC5BAA2{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;}\r\n\t\t\t.cs6BD174F1{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;text-decoration: none;}\r\n\t\t\t.csC1A17A41{color:#0000FF;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;text-decoration: underline;}\r\n\t\t</style>\r\n\t</head>\r\n\t<body>\r\n\t\t<p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">Determine if SQL Server has been patched against Meltdown/Spectre</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">This only checks the SQL Server patch status, not the operating system or hardware</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">This works for SQL Server 2008 through SQL Server 2017</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">You can use a Microsoft-provided PowerShell script to check your </span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">operating system and hardware patch status as decribed in this Microsoft KB </span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">Windows Client Guidance for IT Pros to protect against speculative execution side-channel vulnerabilities</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\"><a class=\"cs6BD174F1\" href=\"https://support.microsoft.com/en-us/help/4073119/protect-against-speculative-execution-side-channel-vulnerabilities-in\"><span class=\"csC1A17A41\">https://support.microsoft.com/en-us/help/4073119/protect-against-speculative-execution-side-channel-vulnerabilities-in</span></a></span><span class=\"csBEC5BAA2\"> </span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">For more info:</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\"><a class=\"cs6BD174F1\" href=\"https://www.sqlskills.com/blogs/glenn/checking-your-sql-server-instance-for-spectremeltdown-patches/\"><span class=\"csC1A17A41\">https://www.sqlskills.com/blogs/glenn/checking-your-sql-server-instance-for-spectremeltdown-patches/</span></a></span><a name=\"_dx_frag_StartFragment\"></a><a name=\"_dx_frag_EndFragment\"></a></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\"><a class=\"cs6BD174F1\" href=\"https://www.sqlskills.com/blogs/glenn/checking-your-meltdown-and-spectre-mitigation-status-in-windows/\"><span class=\"csC1A17A41\">https://www.sqlskills.com/blogs/glenn/checking-your-meltdown-and-spectre-mitigation-status-in-windows/</span></a></span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p></body>\r\n</html>\r\n","AppliesToObjectTypeID":"0a11a887-823a-4461-87af-321cad1c3623","ConditionCategoryID":"805a84c9-7f1b-4b4d-a9ad-3dddcf9e0f17","OwnerObjectID":"b7c74f24-1a45-4115-8262-d7613878bbd6","OwnerObjectTypeID":"894de672-3fc0-4779-9a0d-880d4c207c77","RuleDefinition":"{\"OperationTypeID\":\"6c3d38f1-9317-4258-972a-cfee0a0d76b5\",\"Children\":[{\"OperationTypeID\":\"8fa3cd6a-960c-43bb-96e0-94092fc2c296\",\"ValueDataTypeID\":\"b35a57f5-b8f6-4e4e-9380-e9d328e3eabf\",\"Left\":{\"ValueTypeID\":\"aa61ee90-8a95-4fdf-a208-b9a4afa26d9d\",\"Database\":\"master\",\"Query\":\"\\r\\n-- Check Spectre/Meltdown Status for SQL Server\\r\\n-- Glenn Berry\\r\\n-- SQLskills.com \\r\\n-- Last Modified: February 5, 2020 by Eitan Blumin | https://www.eitanblumin.com\\r\\n\\r\\n--******************************************************************************\\r\\n--*   Copyright (C) 2018 Glenn Berry, SQLskills.com\\r\\n--*   All rights reserved. \\r\\n--*\\r\\n--*   For more scripts and sample code, check out \\r\\n--*      https://www.sqlskills.com/blogs/glenn\\r\\n--*\\r\\n--*   You may alter this code for your own *non-commercial* purposes. You may\\r\\n--*   republish altered code as long as you include this copyright and give due credit. \\r\\n--*\\r\\n--*\\r\\n--*   THIS CODE AND INFORMATION ARE PROVIDED \\\"AS IS\\\" WITHOUT WARRANTY OF \\r\\n--*   ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED \\r\\n--*   TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A\\r\\n--*   PARTICULAR PURPOSE. \\r\\n--*\\r\\n--******************************************************************************\\r\\n\\r\\n-- Determine if SQL Server has been patched against Meltdown/Spectre\\r\\n-- This only checks the SQL Server patch status, not the operating system or hardware\\r\\n-- This works for SQL Server 2008 through SQL Server 2017\\r\\n\\r\\n-- You can use a Microsoft-provided PowerShell script to check your \\r\\n-- operating system and hardware patch status as decribed in this Microsoft KB \\r\\n\\r\\n-- Windows Client Guidance for IT Pros to protect against speculative execution side-channel vulnerabilities\\r\\n-- https://support.microsoft.com/en-us/help/4073119/protect-against-speculative-execution-side-channel-vulnerabilities-in\\r\\n\\r\\nSET NOCOUNT ON;\\r\\n\\r\\n-- Declare variables\\r\\nDECLARE @MachineIdentification varchar(128) = '';\\r\\nDECLARE @ProductVersion varchar(20) =  ISNULL(CONVERT(varchar(20), SERVERPROPERTY('ProductVersion')), '');\\r\\nDECLARE @ProductBuild int = ISNULL(CONVERT(int, SERVERPROPERTY('ProductBuild')), 0);\\r\\nDECLARE @PatchStatus varchar(15) = 'not patched';\\r\\nDECLARE @FinalPatchMessage varchar(256) = '';\\r\\n\\r\\nSET @MachineIdentification = 'Server ' + CONVERT(varchar(256), SERVERPROPERTY ('ServerName')) + ', ';\\r\\n\\r\\n\\r\\n-- Figure out major version number and then get the build number\\r\\n\\r\\n-- SQL Server 2008\\r\\nIF (@ProductVersion LIKE '10.0%')\\r\\nBEGIN\\r\\n IF @ProductVersion = '10.0.6556.0'\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2008, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2008 SP4 GDR: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057114\\r\\n-- Build 10.0.6556.0\\r\\n\\r\\n\\r\\n-- SQL Server 2008 R2\\r\\nIF (@ProductVersion LIKE '10.5%')\\r\\nBEGIN\\r\\n IF @ProductVersion = '10.50.6560.0'\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2008 R2, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n\\r\\n-- Description of the security update for SQL Server 2008 R2 SP3 GDR: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057113\\r\\n-- 10.50.6560.0 \\r\\n\\r\\n\\r\\n-- SQL Server 2012 \\r\\n-- We have ProductBuild in SQL Server 2012 and newer\\r\\nIF (@ProductVersion LIKE '11%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 7462\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2012, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2012 SP4 GDR: January 12, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057116\\r\\n-- Build 11.0.7462.6\\r\\n\\r\\n\\r\\n-- SQL Server 2014\\r\\nIF (@ProductVersion LIKE '12%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 5571 -- SP2 CU\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 5214 -- SP2 GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2014, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2014 SP2 CU10: January 16, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057117\\r\\n-- Build 12.0.5571.0\\r\\n\\r\\n-- Description of the security update for SQL Server 2014 SP2 GDR: January 16, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057120\\r\\n-- Build 12.0.5214.6\\r\\n\\r\\n\\r\\n-- SQL Server 2016\\r\\nIF (@ProductVersion LIKE '13%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 4466 -- SP1 CU7\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 4210  -- SP1 GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 2218  -- RTM CU\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 1745  -- RTM GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2016, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2016 CU7 SP1: January 3, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058561\\r\\n-- Build 13.0.4466.4\\r\\n \\r\\n-- Description of the security update for SQL Server 2016 GDR SP1: January 3, 2018 \\r\\n-- https://support.microsoft.com/en-us/help/4057118\\r\\n-- Build 13.0.4210.6\\r\\n\\r\\n-- Description of the security update for SQL Server 2016 CU: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058559\\r\\n-- Build 13.0.2218.0 \\r\\n\\r\\n-- Description of the security update for SQL Server 2016 GDR: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058560\\r\\n-- Build 13.0.1745.2 \\r\\n\\r\\n\\r\\n-- SQL Server 2017\\r\\nIF (@ProductVersion LIKE '14%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 3015 -- 2017 CU3\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 2000  -- 2017 GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2017, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2017 GDR: January 3, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057122\\r\\n-- Build 14.0.2000.63\\r\\n \\r\\n-- Description of the security update for SQL Server 2017 CU3 RTM: January 3, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058562\\r\\n-- Build 14.0.3015.40 \\r\\n\\r\\n\\r\\n-- SQL Server Guidance to protect against speculative execution side-channel vulnerabilities\\r\\n-- https://support.microsoft.com/en-us/help/4073225/guidance-for-sql-server \\r\\n\\r\\n\\r\\nPRINT @FinalPatchMessage;\\r\\nSELECT @FinalPatchMessage AS [SQL Server Patch Status], CASE @PatchStatus WHEN 'patched' THEN 0 ELSE 1 END AS NeedsToBePatched\\r\\nWHERE @FinalPatchMessage <> ''\",\"InstanceType\":1},\"ComparisonType\":0,\"Right\":{\"ValueTypeID\":\"07f87b7f-c063-47a2-a5be-772ba85ed827\",\"Value\":\"1\"},\"ID\":\"1\"}],\"BooleanOperationType\":0,\"ID\":\"0\"}","EvaluationFrequency":"1.00:00:00","IdlePeriod":"00:00:30","MaximumAllowedDuration":"00:00:05","AntiConditionID":"21bf5524-8d62-4709-98d7-fbc935715be7","MinWindowsVersion":null,"MaxWindowsVersion":null,"MinSQLServerVersion":"10.0","MaxSQLServerVersion":"14.1","MinSSASVersion":null,"MaxSSASVersion":null,"MinVmwareVersion":null,"MaxVmwareVersion":null,"MinSqlDbVersion":null,"MaxSqlDbVersion":null,"MaximumInstanceCount":1,"ColorIndicator":null,"Severity":1,"Signature":{"ConditionID":"d970f81f-5942-4afb-a97d-2968c6c42704","VersionNumber":1,"AppliesToObjectTypeID":"0a11a887-823a-4461-87af-321cad1c3623","RuleDefinition":"{\"OperationTypeID\":\"6c3d38f1-9317-4258-972a-cfee0a0d76b5\",\"Children\":[{\"OperationTypeID\":\"8fa3cd6a-960c-43bb-96e0-94092fc2c296\",\"ValueDataTypeID\":\"b35a57f5-b8f6-4e4e-9380-e9d328e3eabf\",\"Left\":{\"ValueTypeID\":\"aa61ee90-8a95-4fdf-a208-b9a4afa26d9d\",\"Database\":\"master\",\"Query\":\"\\r\\n-- Check Spectre/Meltdown Status for SQL Server\\r\\n-- Glenn Berry\\r\\n-- SQLskills.com \\r\\n-- Last Modified: February 5, 2020 by Eitan Blumin | https://www.eitanblumin.com\\r\\n\\r\\n--******************************************************************************\\r\\n--*   Copyright (C) 2018 Glenn Berry, SQLskills.com\\r\\n--*   All rights reserved. \\r\\n--*\\r\\n--*   For more scripts and sample code, check out \\r\\n--*      https://www.sqlskills.com/blogs/glenn\\r\\n--*\\r\\n--*   You may alter this code for your own *non-commercial* purposes. You may\\r\\n--*   republish altered code as long as you include this copyright and give due credit. \\r\\n--*\\r\\n--*\\r\\n--*   THIS CODE AND INFORMATION ARE PROVIDED \\\"AS IS\\\" WITHOUT WARRANTY OF \\r\\n--*   ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED \\r\\n--*   TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A\\r\\n--*   PARTICULAR PURPOSE. \\r\\n--*\\r\\n--******************************************************************************\\r\\n\\r\\n-- Determine if SQL Server has been patched against Meltdown/Spectre\\r\\n-- This only checks the SQL Server patch status, not the operating system or hardware\\r\\n-- This works for SQL Server 2008 through SQL Server 2017\\r\\n\\r\\n-- You can use a Microsoft-provided PowerShell script to check your \\r\\n-- operating system and hardware patch status as decribed in this Microsoft KB \\r\\n\\r\\n-- Windows Client Guidance for IT Pros to protect against speculative execution side-channel vulnerabilities\\r\\n-- https://support.microsoft.com/en-us/help/4073119/protect-against-speculative-execution-side-channel-vulnerabilities-in\\r\\n\\r\\nSET NOCOUNT ON;\\r\\n\\r\\n-- Declare variables\\r\\nDECLARE @MachineIdentification varchar(128) = '';\\r\\nDECLARE @ProductVersion varchar(20) =  ISNULL(CONVERT(varchar(20), SERVERPROPERTY('ProductVersion')), '');\\r\\nDECLARE @ProductBuild int = ISNULL(CONVERT(int, SERVERPROPERTY('ProductBuild')), 0);\\r\\nDECLARE @PatchStatus varchar(15) = 'not patched';\\r\\nDECLARE @FinalPatchMessage varchar(256) = '';\\r\\n\\r\\nSET @MachineIdentification = 'Server ' + CONVERT(varchar(256), SERVERPROPERTY ('ServerName')) + ', ';\\r\\n\\r\\n\\r\\n-- Figure out major version number and then get the build number\\r\\n\\r\\n-- SQL Server 2008\\r\\nIF (@ProductVersion LIKE '10.0%')\\r\\nBEGIN\\r\\n IF @ProductVersion = '10.0.6556.0'\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2008, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2008 SP4 GDR: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057114\\r\\n-- Build 10.0.6556.0\\r\\n\\r\\n\\r\\n-- SQL Server 2008 R2\\r\\nIF (@ProductVersion LIKE '10.5%')\\r\\nBEGIN\\r\\n IF @ProductVersion = '10.50.6560.0'\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2008 R2, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n\\r\\n-- Description of the security update for SQL Server 2008 R2 SP3 GDR: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057113\\r\\n-- 10.50.6560.0 \\r\\n\\r\\n\\r\\n-- SQL Server 2012 \\r\\n-- We have ProductBuild in SQL Server 2012 and newer\\r\\nIF (@ProductVersion LIKE '11%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 7462\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2012, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2012 SP4 GDR: January 12, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057116\\r\\n-- Build 11.0.7462.6\\r\\n\\r\\n\\r\\n-- SQL Server 2014\\r\\nIF (@ProductVersion LIKE '12%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 5571 -- SP2 CU\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 5214 -- SP2 GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2014, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2014 SP2 CU10: January 16, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057117\\r\\n-- Build 12.0.5571.0\\r\\n\\r\\n-- Description of the security update for SQL Server 2014 SP2 GDR: January 16, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057120\\r\\n-- Build 12.0.5214.6\\r\\n\\r\\n\\r\\n-- SQL Server 2016\\r\\nIF (@ProductVersion LIKE '13%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 4466 -- SP1 CU7\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 4210  -- SP1 GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 2218  -- RTM CU\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 1745  -- RTM GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2016, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2016 CU7 SP1: January 3, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058561\\r\\n-- Build 13.0.4466.4\\r\\n \\r\\n-- Description of the security update for SQL Server 2016 GDR SP1: January 3, 2018 \\r\\n-- https://support.microsoft.com/en-us/help/4057118\\r\\n-- Build 13.0.4210.6\\r\\n\\r\\n-- Description of the security update for SQL Server 2016 CU: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058559\\r\\n-- Build 13.0.2218.0 \\r\\n\\r\\n-- Description of the security update for SQL Server 2016 GDR: January 6, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058560\\r\\n-- Build 13.0.1745.2 \\r\\n\\r\\n\\r\\n-- SQL Server 2017\\r\\nIF (@ProductVersion LIKE '14%')\\r\\nBEGIN\\r\\n IF @ProductBuild >= 3015 -- 2017 CU3\\r\\n   SET @PatchStatus = 'patched';\\r\\n IF @ProductBuild = 2000  -- 2017 GDR\\r\\n   SET @PatchStatus = 'patched';\\r\\n SET @FinalPatchMessage = @MachineIdentification + N'SQL Server 2017, Build Number ' + @ProductVersion + '. This SQL Server instance is ' + @PatchStatus + + ' against Spectre/Meltdown.';\\r\\nEND\\r\\n\\r\\n-- Description of the security update for SQL Server 2017 GDR: January 3, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4057122\\r\\n-- Build 14.0.2000.63\\r\\n \\r\\n-- Description of the security update for SQL Server 2017 CU3 RTM: January 3, 2018\\r\\n-- https://support.microsoft.com/en-us/help/4058562\\r\\n-- Build 14.0.3015.40 \\r\\n\\r\\n\\r\\n-- SQL Server Guidance to protect against speculative execution side-channel vulnerabilities\\r\\n-- https://support.microsoft.com/en-us/help/4073225/guidance-for-sql-server \\r\\n\\r\\n\\r\\nPRINT @FinalPatchMessage;\\r\\nSELECT @FinalPatchMessage AS [SQL Server Patch Status], CASE @PatchStatus WHEN 'patched' THEN 0 ELSE 1 END AS NeedsToBePatched\\r\\nWHERE @FinalPatchMessage <> ''\",\"InstanceType\":1},\"ComparisonType\":0,\"Right\":{\"ValueTypeID\":\"07f87b7f-c063-47a2-a5be-772ba85ed827\",\"Value\":\"1\"},\"ID\":\"1\"}],\"BooleanOperationType\":0,\"ID\":\"0\"}","PublisherID":0,"PublishDateUtc":"2020-04-05T14:58:27","Rights":0,"SignatureVersion":1,"SignaturePublicKey":"<RSAKeyValue><Modulus>uzJQ9gzevXFwOgw/hkcAtD+cA/bBbD1PRzhEZCxbZ6YwjJ1c9bbfXFItLQNwnm8bdWh2k57//qbpEj5DFHOW2EAjHc2Zw5m/vACm6OzelubPS5hbWvzshlaBJKm7KrpWQpPZClx/5eVvUVzOtlz+44RRTiOszObT58acJAQwA70=</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>","Signature":"rx+7eKI373nCiILBgJL7892eI6DeyatzxUvl93txx03DKVai1LpFolj1o1Da05fCJbtJyOL0DurTeqkyqPygkgpWeSiRDh4Aq4i6cZogKiNHCTgKFOoWNJ30+k1cVu/MySeQ5oYYkj/0AgNdjpn0UaVRzi7Q9frNlBCIYkr95ZU=","IsSelfPublishedCondition":true},"Tags":"Security","Areas":[],"ConditionSystemVersion":3,"MinDBSchemaVersion":null,"MaxDBSchemaVersion":null,"Items":[]}