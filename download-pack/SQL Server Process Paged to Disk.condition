{"ID":"2a9312ff-ffdf-45db-a7d5-08a452263c38","VersionNumber":1,"Name":"SQL Server Process Paged to Disk","Description":"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<head>\r\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>\r\n\t\t</title>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t.cs2654AE3A{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}\r\n\t\t\t.csBEC5BAA2{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;}\r\n\t\t\t.csF6EF92FE{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:bold;font-style:normal;}\r\n\t\t\t.cs6BD174F1{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;text-decoration: none;}\r\n\t\t\t.csC1A17A41{color:#0000FF;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;text-decoration: underline;}\r\n\t\t\t.cs56620BC5{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;text-decoration: underline;}\r\n\t\t</style>\r\n\t</head>\r\n\t<body>\r\n\t\t<p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">Under severe memory pressure Windows can page the SQL Server process to disk, which can dramatically impact SQL Server performance. This custom condition will query the ring buffer for the latest working set utilization value for the SQL Server process, and alert if it drops below 75%. If no record exists, 100(%) will be returned, which is the optimal state.</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">By default the query only looks for resource monitor entries within the past 2 hours. This is to prevent the condition from staying active indefinitely if recovery values aren&#39;t logged after the process has been returned to memory. This threshold can be modified as needed.</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">Note that if the </span><span class=\"csF6EF92FE\">Lock pages in memory</span><span class=\"csBEC5BAA2\"> user right has been assigned to the SQL Server service user account, it will prevent Windows from paging the SQL Server process.</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csF6EF92FE\">See Also:</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">How to reduce paging of buffer pool memory in the 64-bit version of SQL Server - <a class=\"cs6BD174F1\" href=\"http://support.microsoft.com/kb/918483\"><span class=\"csC1A17A41\">http://support.microsoft.com/kb/918483</span></a></span></p><p class=\"cs2654AE3A\"><span class=\"cs56620BC5\"><a class=\"cs56620BC5\" href=\"http://sqlserverperformance.wordpress.com/2011/02/14/sql-server-and-the-lock-pages-in-memory-right-in-windows-server/\"><span class=\"csC1A17A41\">http://sqlserverperformance.wordpress.com/2011/02/14/sql-server-and-the-lock-pages-in-memory-right-in-windows-server/</span></a></span></p><p class=\"cs2654AE3A\"><span class=\"cs56620BC5\"><a class=\"cs56620BC5\" href=\"https://www.simple-talk.com/sql/database-administration/great-sql-server-debates-lock-pages-in-memory/\"><span class=\"csC1A17A41\">https://www.simple-talk.com/sql/database-administration/great-sql-server-debates-lock-pages-in-memory/</span></a></span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p></body>\r\n</html>\r\n","AppliesToObjectTypeID":"0a11a887-823a-4461-87af-321cad1c3623","ConditionCategoryID":"805a84c9-7f1b-4b4d-a9ad-3dddcf9e0f17","OwnerObjectID":"b7c74f24-1a45-4115-8262-d7613878bbd6","OwnerObjectTypeID":"894de672-3fc0-4779-9a0d-880d4c207c77","RuleDefinition":"{\"OperationTypeID\":\"6c3d38f1-9317-4258-972a-cfee0a0d76b5\",\"Children\":[{\"OperationTypeID\":\"8fa3cd6a-960c-43bb-96e0-94092fc2c296\",\"ValueDataTypeID\":\"b35a57f5-b8f6-4e4e-9380-e9d328e3eabf\",\"Left\":{\"ValueTypeID\":\"aa61ee90-8a95-4fdf-a208-b9a4afa26d9d\",\"Database\":\"master\",\"Query\":\"SELECT MIN(MemUtilization)\\r\\nFROM\\r\\n(\\r\\n\\tSELECT\\r\\n\\t\\tISNULL(rec.x.value('(MemoryRecord/MemoryUtilization)[1]','tinyint'), 100) As MemUtilization\\r\\n\\tFROM (\\r\\n\\t\\t\\tSELECT TOP 1 CAST(orb.record AS XML) AS xmlRec\\r\\n\\t\\t\\tFROM sys.dm_os_ring_buffers AS orb\\r\\n\\t\\t\\tCROSS JOIN sys.dm_os_sys_info AS osi\\r\\n\\t\\t\\tWHERE orb.ring_buffer_type = 'RING_BUFFER_RESOURCE_MONITOR'\\r\\n\\t\\t\\t  AND DATEADD(second, -((osi.cpu_ticks/(osi.cpu_ticks/osi.ms_ticks) - orb.timestamp) / 1000), GETDATE()) > DATEADD(minute, -120, GETDATE())\\r\\n\\t\\t\\tORDER BY timestamp DESC\\r\\n\\t\\t) rb\\r\\n\\tCROSS APPLY rb.xmlRec.nodes('Record') rec(x)\\r\\n UNION\\r\\n\\tSELECT 100\\r\\n) MU\",\"InstanceType\":0},\"ComparisonType\":4,\"Right\":{\"ValueTypeID\":\"07f87b7f-c063-47a2-a5be-772ba85ed827\",\"Value\":\"75\"},\"ID\":\"1\"}],\"BooleanOperationType\":0,\"ID\":\"0\"}","EvaluationFrequency":"00:05:00","IdlePeriod":"00:05:00","MaximumAllowedDuration":"00:00:05","AntiConditionID":"93675333-84e0-4290-91d9-93a47e6ee760","MinWindowsVersion":null,"MaxWindowsVersion":null,"MinSQLServerVersion":"9.0","MaxSQLServerVersion":null,"MinSSASVersion":null,"MaxSSASVersion":null,"MinVmwareVersion":null,"MaxVmwareVersion":null,"MinSqlDbVersion":null,"MaxSqlDbVersion":null,"MaximumInstanceCount":1,"ColorIndicator":null,"Severity":2,"Signature":{"ConditionID":"2a9312ff-ffdf-45db-a7d5-08a452263c38","VersionNumber":1,"AppliesToObjectTypeID":"0a11a887-823a-4461-87af-321cad1c3623","RuleDefinition":"{\"OperationTypeID\":\"6c3d38f1-9317-4258-972a-cfee0a0d76b5\",\"Children\":[{\"OperationTypeID\":\"8fa3cd6a-960c-43bb-96e0-94092fc2c296\",\"ValueDataTypeID\":\"b35a57f5-b8f6-4e4e-9380-e9d328e3eabf\",\"Left\":{\"ValueTypeID\":\"aa61ee90-8a95-4fdf-a208-b9a4afa26d9d\",\"Database\":\"master\",\"Query\":\"SELECT MIN(MemUtilization)\\r\\nFROM\\r\\n(\\r\\n\\tSELECT\\r\\n\\t\\tISNULL(rec.x.value('(MemoryRecord/MemoryUtilization)[1]','tinyint'), 100) As MemUtilization\\r\\n\\tFROM (\\r\\n\\t\\t\\tSELECT TOP 1 CAST(orb.record AS XML) AS xmlRec\\r\\n\\t\\t\\tFROM sys.dm_os_ring_buffers AS orb\\r\\n\\t\\t\\tCROSS JOIN sys.dm_os_sys_info AS osi\\r\\n\\t\\t\\tWHERE orb.ring_buffer_type = 'RING_BUFFER_RESOURCE_MONITOR'\\r\\n\\t\\t\\t  AND DATEADD(second, -((osi.cpu_ticks/(osi.cpu_ticks/osi.ms_ticks) - orb.timestamp) / 1000), GETDATE()) > DATEADD(minute, -120, GETDATE())\\r\\n\\t\\t\\tORDER BY timestamp DESC\\r\\n\\t\\t) rb\\r\\n\\tCROSS APPLY rb.xmlRec.nodes('Record') rec(x)\\r\\n UNION\\r\\n\\tSELECT 100\\r\\n) MU\",\"InstanceType\":0},\"ComparisonType\":4,\"Right\":{\"ValueTypeID\":\"07f87b7f-c063-47a2-a5be-772ba85ed827\",\"Value\":\"75\"},\"ID\":\"1\"}],\"BooleanOperationType\":0,\"ID\":\"0\"}","PublisherID":0,"PublishDateUtc":"2015-07-17T17:23:27","Rights":0,"SignatureVersion":1,"SignaturePublicKey":"<RSAKeyValue><Modulus>uzJQ9gzevXFwOgw/hkcAtD+cA/bBbD1PRzhEZCxbZ6YwjJ1c9bbfXFItLQNwnm8bdWh2k57//qbpEj5DFHOW2EAjHc2Zw5m/vACm6OzelubPS5hbWvzshlaBJKm7KrpWQpPZClx/5eVvUVzOtlz+44RRTiOszObT58acJAQwA70=</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>","Signature":"ENkUB0PBkBM/gDFBr56QxRaTpYNfqiQGa7YYSZHhWjhKqOT46p18CDALr9qPWuKeZzc9QzahQxJG1e2WYtZU7TwryKz4g5+1xJsVQcF2JeNjdDnWNnSEwIY6WI/3s+DI/kTdzxao0wDry+aViFeeTKEr5ryLnqHM+INgzd/VH4E=","IsSelfPublishedCondition":true},"Tags":"Performance,Memory","Areas":["SQL Server: Memory Usage","Windows: Hard Faults","Windows: Memory Usage"],"ConditionSystemVersion":3,"MinDBSchemaVersion":null,"MaxDBSchemaVersion":null,"Items":[]}